/*!
 * mod.js
 * ------
 * Class library and module container for jQuery
 * 
 * @version 0.0.2 (2015-06-08)
 * @author mach3 <http://github.com/mach3>
 * @license MIT
 */

!function(a,b){"use strict";var c={chain:function(){var b,d,e,f,g;return b=a.Deferred(),d=c.toArray(arguments),e=c.type(d[0],"Number")?d.shift():1,f=function(){return clearTimeout(g),d.length?c.type(d[0],"Function")?(e=d.shift()(),!1===e?b.reject():(e=e||1,void(g=setTimeout(f,e)))):b.reject():b.resolve()},g=setTimeout(f,e),b.promise()},escapeHTML:function(b){return a("<i>").append(document.createTextNode(b)).html()},format:function(){var a=c.toArray(arguments);return a.shift().replace(/%s/g,function(){return a.length?a.shift():""})},forReverse:function(a,b){for(var c=a.length;c--;)if(!1===b(a[c],c))return},path:function(b,c){var d=b;return a.each(c.split("."),function(a,b){return void 0===d?!1:void(d=d[b])}),d},serialize:function(b){var d={};return a(b).serializeArray().forEach(function(a){return void 0!==d[a.name]?(c.type(d[a.name],"Array")||(d[a.name]=[d[a.name]]),d[a.name].push(a.value)):void(d[a.name]=a.value)}),d},template:function(b,d,e){var f=function(d,e){var f=b.replace(/([\{]{2,3})([\w\.\-]+?)(?:[\}]{2,3})/g,function(a,b,e){var f=c.path(d,e);return f=void 0===f?"":f,f=b.length>2?f:c.escapeHTML(f)});return e?a("<i>").append(f).children():f};return 1===arguments.length?f:f(d,e)},toArray:function(a){return Array.prototype.slice.call(a)},type:function(a,b){var c,d;return c=Object.prototype.toString.call(a).match(/^\[object\s(\w+)\]$/),d=c?c[1]:void 0,b?d===b:d}},d={_modules:{},_instances:{},_logging:!1,exports:function(a,b,c){return a in this._modules&&!c?this.error("module '"+a+"' already exists"):this._modules[a]=b,this},getInstance:function(a){var b=this.find(a);return c.type(b,"Function")?new b:b},require:function(a,b){var c;return!b&&a in this._instances?this._instances[a]:(c=this.getInstance(a),b||(this._instances[a]=c),c)},find:function(a){return this._modules[a]||void 0},log:function(){return this._logging&&console&&console.log&&console.log.apply(console,arguments),this},error:function(){return this._logging&&console&&console.error&&console.error.apply(console,arguments),this}};d.Class=function(a){var b=function(){var a,b,d;a=this,d=arguments,b=function(e){c.type(e._parents,"Array")&&c.forReverse(e._parents,b),c.type(e._initialize,"Function")&&e._initialize.apply(a,d)},c.forReverse(this._parents,b)};return b.extend=d.Class.extend,b["new"]=d.Class["new"],b.extend(a,!0),b.extend("class"),a._extends instanceof Array&&a._extends.forEach(function(a){b.extend(a)}),b},d.Class.extend=function(){var b,e,f,g;return b=this,e=c.toArray(arguments),f=!1,c.type(e[e.length-1],"Boolean")&&(f=e.pop()),e.length>1?(a.each(e,function(a,c){b.extend(c,f)}),this):(g=c.type(e[0],"String")?d.find(e[0]):e[0],g=c.type(g,"Function")?g.prototype:g,f?a.extend(!0,this.prototype,g):a.each(g,function(c,d){"_initialize"===c||"_parents"===c||c in b.prototype||(b.prototype[c]="object"===a.type(d)?a.extend(!0,{},d):d)}),this.prototype._parents=this.prototype._parents||[],this.prototype._parents.push(g),this)},d.Class["new"]=function(){var a=[""].concat(c.toArray(arguments));return new(this.bind.apply(this,a))},d.exports("class",{_initialize:function(){this.bind(/^_/)},bind:function(b){var d,e;return e=c.toArray(arguments),d=this,e.length>1?(a.each(e,function(a,b){d.bind(b)}),this):c.type(b,"RegExp")?(a.each(this,function(a,e){b.test(a)&&c.type(e,"Function")&&d.bind(a)}),this):(this[b]=a.proxy(this[b],this),this)}}),d.exports("events",{_emitter:null,_initialize:function(){var b=this;this._emitter=a(this),a.each(["on","off","trigger"],function(a,c){b[c]=function(){return this._emitter[c].apply(this._emitter,arguments),this}})}}),d.exports("config",{_options:null,options:null,_initialize:function(){this.options=a.extend(!0,{},this._options)},config:function(b,d){switch(c.type(b)){case"String":if(1===arguments.length)return this.options[b];this.options[b]=d;break;case"Object":a.extend(!0,this.options,b);break;case"Undefined":return this.options}return this}}),d.exports("attributes",{_attributes:null,attributes:null,_initialize:function(){this.attributes=a.extend(!0,{},this._attributes)},attr:function(b,d){var e,f=this;switch(c.type(b)){case"String":if(1===arguments.length)return this.attributes[b];e=this.attributes[b]!==d,this.attributes[b]=d,e&&a.isFunction(this.trigger)&&this.trigger("change",{key:b,value:d});break;case"Object":return a.each(b,function(a,b){f.attr(a,b)}),this;case"Undefined":return this.attributes}return this}}),d.exports("collection",d.Class({EVENT_UPDATE:"update",_extends:["events"],data:null,index:-1,_initialize:function(){this.data=[]},push:function(){return this.add(arguments,"push"),this},unshift:function(){return this.add(arguments,"unshift"),this},add:function(b,d){var e=this;return d=d||"push",b=c.type(b,"Object")?[b]:b,a.each(b,function(a,b){b.__id__=++e.index,e.data[d](b)}),this.trigger(this.EVENT_UPDATE),this},remove:function(a){var b=[],c=!1;return this.data.forEach(function(d){return a(d)?void(c=!0):void b.push(d)}),this.data=b,c&&this.trigger(this.EVENT_UPDATE),this},filter:function(b){return a.grep(this.data,b)},find:function(b){return c.type(b,"String")&&arguments.length>1&&(b={},b[arguments[0]]=arguments[1]),this.filter(function(c){var d=!0;return a.each(b,function(a,b){return c[a]!==b?(d=!1,!1):void 0}),d})},each:function(a){return this.get().forEach(a),this},get:function(a){return c.type(a,"Number")?this.data[a]||void 0:this.data}})),d.exports("observer",d.Class({EVENT_CHANGE:"change",_extends:["config","events"],_options:{target:null,property:"",callback:null,interval:50},watching:!1,util:null,latest:void 0,timer:null,_initialize:function(){this.util=d.require("util")},isHashChange:function(){var a=this.config();return!a.callback&&"onhashchange"in window&&a.target===location&&"hash"===a.property},watch:function(){var b=this.config();return b.target=b.target||window,this.isHashChange()?a(window).on("hashchange",this._onHashChange):(this.watching=!0,this._process()),this},unwatch:function(){return this.isHashChange()?a(window).off("hashchange",this._onHashChange):(this.watching=!1,this.timer&&clearTimeout(this.timer),this.latest=void 0),this},value:function(){var a=this.config();return c.type(a.callback,"Function")?a.callback():c.path(a.target,a.property)},_process:function(){var a,b=this.config();this.timer&&clearTimeout(this.timer),this.watching&&(a=this.value(),void 0!==this.latest&&this.latest!==a&&this.trigger(this.EVENT_CHANGE,a),this.latest=a,this.timer=setTimeout(this._process,b.interval))},_onHashChange:function(){this.config();this.trigger(this.EVENT_CHANGE,location.hash)}})),d.exports("routes",d.Class({EVENT_ERROR:"error",_extends:["config","events"],_options:{mode:"pathname",single:!1,defaultPath:null},observer:null,actions:null,util:null,_initialize:function(){this.observer=d.require("observer",!0).config({target:location}),this.actions=[]},resolve:function(b,d){var e,f,g;return e=this.config(),f=this,g=!1,b=void 0===b?location[e.mode].slice():b,a.each(this.actions,function(a,d){var h,i=!1;switch(c.type(d.rule)){case"RegExp":h=b.match(d.rule),i=!!h;break;case"Boolean":i=d.rule;break;case"Function":i=d.rule(b)}return i&&f.run(d.action,h)&&(g=!0,e.single)?!1:void 0}),g||(this.trigger(this.EVENT_ERROR),e.defaultPath&&!d&&this.resolve(e.defaultPath,!0)),this},run:function(a,b){return c.type(a,"String")&&(a=c.type(d.find(a)["new"],"Function")?d.require(a):d.find(a)),a?(a=c.type(a["new"],"Function")?a["new"].apply(a,b):a,c.type(a._onRoute,"Function")&&a._onRoute.apply(a,b),c.type(a,"Function")&&a.apply(a,b),!0):!1},watch:function(a){a=void 0===a?!0:a,this.observer.unwatch().config({property:this.config("mode")}).watch(),this.observer[a?"on":"off"]("change",this._onChange)},unwatch:function(){return this.watch(!1)},_onChange:function(){this.resolve()},action:function(a,b){return c.type(a,"Object")?this.action(a.rule,a.action):(a=c.type(a,"String")?new RegExp(a):a,b&&this.actions.push({rule:a,action:b}),this)},map:function(b){var c=this;return a.each(b,function(){c.action.apply(c,arguments)}),this}})),d.exports("util",c),d.util=d.require("util"),b.mod=d}(jQuery,this);
//# sourceMappingURL=mod.dev.js.map